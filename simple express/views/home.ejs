<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="/styles/styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
</head>
<body>
    <h2>Home</h2>
    <hr>
    <h3>Albums</h3>
    
    <!-- React component will be injected here -->
    <div id="root"></div>

    <script type="text/babel">
      // Get albums data from the server
      const albums = <%- albums %>;

      const getAll = () => albums;
      const getItem = (title) => albums.find(album => album.title === title);
      const deleteAlbum = (title) => {
        const index = albums.findIndex(album => album.title === title);
        if (index !== -1) {
          return albums.splice(index, 1)[0];
        }
        return null;
      };

      function AlbumList() {
        const [selectedAlbum, setSelectedAlbum] = React.useState(null);

        const handleClick = (title) => {
          const album = getItem(title);
          setSelectedAlbum(album);
        };

        const handleDelete = (title) => {
          const deletedAlbum = deleteAlbum(title);
          if (deletedAlbum) {
            alert(`${deletedAlbum.title} was deleted!`);
            setSelectedAlbum(null);
          } else {
            alert("Album not found!");
          }
        };

        return (
          <div>
            {!selectedAlbum ? (
              <div>
                <ul>
                  {getAll().map((album, index) => (
                    <li key={index}>
                      <button onClick={() => handleClick(album.title)}>{album.title}</button>
                      <button onClick={() => handleDelete(album.title)}>Delete</button>
                    </li>
                  ))}
                </ul>
              </div>
            ) : (
              <div>
                <h2>{selectedAlbum.title}</h2>
                <p>Artist: {selectedAlbum.artist}</p>
                <p>Release Year: {selectedAlbum.releaseYear}</p>
                <button onClick={() => setSelectedAlbum(null)}>Back to List</button>
              </div>
            )}
          </div>
        );
      }

      ReactDOM.render(<AlbumList />, document.getElementById('root'));
    </script>
</body>
</html>
